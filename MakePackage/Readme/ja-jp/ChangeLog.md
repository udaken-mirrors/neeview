## 更新履歴

----

### 42.0
(2024-11-??)

#### 追加

- システム：ダイアログとトースト通知のテキストをクリップボードにコピーできるようにした
- システム：エクスプローラーに代わるファイルマネージャーを設定できるようにした (設定 > 全般)
- システム：動画ページのコンテキストメニューから「ブックとして開く」を選択できるようにした
- システム：アーカイブフォルダー単位のコピーに対応
- システム：サンプルテーマのJSONファイルにフォーマット説明のWikiページへのリンクを埋め込んだ
- コマンド：「ファイルに保存」コマンドのパラメーターにトースト通知のフラグを追加
- コマンド：選択式の「外部アプリを開く」コマンド追加。 ページメニューのコマンドと同等です
- コマンド：選択式の「フォルダーにコピー」コマンド追加。ページメニューのコマンドと同等です
- コマンド：選択式の「フォルダーに移動」コマンド追加。ページメニューのコマンドと同等です
- ブック：ページ分割時の分割レート設定を追加 (設定 > ブック > 分割ページの割合) 
- ブック：「2 ページ表示」のときの基準ページを番号でのみ決める設定を追加 (設定 > ブック)
- ブック：「2 ページ表示」での各ページのサイズの揃え方の設定を追加 (設定 > ブック)
- ブック：画像開始位置を水平方向と垂直方向それぞれに設定できるようにした (設定 > 画像操作) 
- アドレスバー：ブックの切り替えを禁止するボタンをアドレスバーに追加
- パネル：情報パネルとフィルムストリップのページコンテキストメニューでも名前変更等のページリストコンテキストメニューと同じ操作を実行できるようにした
- パネル：サイドパネルアイコンに選択マーク表示
- メインビューウィンドウ：メインビューウィンドウを閉じたときに メインビューウィンドウモードを解除する設定を追加 (設定 > メインビュー) 
- メインビューウィンドウ：「メインビュー ウィンドウ自動表示」設定追加 (設定 > メインビュー)
- プレイリスト：プレイリストの「パス順に並び替える」に確認ダイアログを追加
- プレイリスト：プレイリストパネルで複数指定の項目移動をできるようにした
- プレイリスト：プレイリストパネルの「現在のブックのみ表示」にプレイリストブック対応
- プレイリスト：プレイリスト項目の移動ボタンを Ctrl を押しながらクリックすると終端まで移動するようにした
- プレイリスト：プレイリストブックを開いているときのみプレイリスト項目のコンテキストメニューに「元のファイルを開く」を追加
- スクリプト：ブックの名前変更時の OnBookLoaded.nvjs スクリプト呼び出し設定を追加 (設定 > スクリプト)
- スクリプト：スクリプト コンソールにテーマ適用
- スクリプト：スクリプトに SQLite アクセスを追加する設定を追加 (設定 > スクリプト)
- スクリプト：スクリプトコマンドのコマンドパラメーターにメニュー用フラグ IsChecked を追加
- スクリプト：コマンドラインの起動スクリプト指定で "script:hogehoge.nvjs" とすることでスクリプトフォルダにあるファイルを指定できるようにした
- スクリプト：起動時のイベントスクリプト OnStartup.nvjs 対応
- スクリプト：ウィンドウ状態変更イベント OnWindowStateChanged.nvjs 対応
- スクリプト：スクリプトのドックコメントに @args を追加
- スクリプト：本棚のツリービューを操作する nv.Bookshelf.FolderTree を追加
- スクリプト：ブックマークパネルのツリービューを操作する nv.Bookmark.FolderTree を追加
- スクリプト：nv.ShowInputDialog(title, message, text) 追加
- スクリプト：本棚の表示が完了するまで待機する nv.Bookshelf.Wait() を追加
- スクリプト：動画のコントロールを行う nv.Book.ViewPages[].Player を追加 
- スクリプト：Susieプラグインを操作する nv.SusiePluginCollection 追加
- スクリプト：移動やコピー先フォルダーを管理する nv.DestinationFolderCollection 追加
- スクリプト：外部アプリ設定を管理する nv.ExternalAppCollection を追加
- スクリプト：ページ番号 PageAccessor.Index を追加
- スクリプト：コマンド名 CommandAccessor.Name 追加
- スクリプト：ブックマークフラグ nv.Book.IsBookmarked 追加
- スクリプト：BookshelfPanelAccessor に MoveToParent() 等を追加
- スクリプト：ファイル操作系コマンド nv.FileCopy(), nv.FileMove(), nv.FileDelete() を追加。
- スクリプト：パッケージ情報 nv.Environment 整備
- スクリプト：ブックやページの Size, LastWriteTime, CreationTime の整備
- スクリプト：現在実行中のコマンドのアクセサ nv.CurrentCommand 追加。
- スクリプト：現在実行中のスクリプトファイルのパス nv.ScriptPath を追加

#### 変更

- システム：ファイルのドロップでウィンドウをアクティブ化するようにした
- システム：メインウィンドウ表示開始時にアクティブにするようにした
- システム：コピー内容設定の一部をファイルコピーコマンドパラメータからシステム設定に移動 (設定 > 全般 > コピー内容の方針)
- システム：起動処理の最適化
- ブック：設定ページ数移動でもページ終端判定を行うようにした 
- ブック：シームレスループでもループ通知するようにした 
- アドレスバー：アドレスバーを選択したときにパステキストを選択した状態にするようにした。
- アドレスバー：アドレスバーに画像ファイルパスを入力したときにはそのページを含むブックとして開けるようにした
- メインビューウィンドウ：メインビューウィンドウモードからの復帰時にページリストパネルをできるだけ元の状態にもどすようにした
- 本棚：ブックの再読み込みで本棚の選択項目を変更しないようにした
- 本棚：本棚から複数まとめて履歴削除できるようにした
- プレイリスト：現在のプレイリストをブックとして開いているときにプレイリスト項目を開くと現在のブックでのページ移動になるようにした
- プレイリスト：プレイリストブックのページをプレイリストに登録するときは実体を登録するようにした
- プレイリスト：プレイリストブックで「サブフォルダーを読み込む」を有効にした
- 情報パネル：追加情報がない場合は「なし」を表示するようにした
- スクリプト：PageAccessor.Path を実体パスに変更
- スクリプト：LastWriteTime 等の日時の値の型を string から Date に変更

####  不具合修正

- システム：多重起動制限が機能しないことがある不具合修正
- システム：多重起動時に履歴がマージされないことがある不具合修正
- システム：圧縮ファイル単位で展開したときに動画が含まれない不具合修正
- システム：コマンドラインヘルプの文字化け修正
- システム：メニューなどのUIアニメーションが Windows の設定に従っていない不具合修正 
- システム：印刷を選択するとエラーになることがある不具合対策
- ブック：アニメーション画像準備中にページを閉じたときにエラーが発生する現象を軽減した 
- ブック：シームレスループでのページ位置不具合を修正
- ブック：シームレスループ中にフォルダーページ移動したときにエラーになることがある不具合修正
- ブック：ページ分割時にロード中表示が消えないことがある不具合修正
- ブック：ストレッチ変更でタイトルテキストのスケールが変わらない不具合修正
- ブック：「ディレクトリ単位で展開」のときにアーカイブパスによる開始ページ指定が機能しないことがある不具合修正
- パネル：複数選択からの単一選択で選択処理が実行されない不具合修正
- ページリスト：ダミーアイコンの巨大なポップアップが表示される不具合修正
- ページリスト：ページ検索切替時にエラーになることがある不具合修正
- プレイリスト：プレイリストパネルの＋ボタンの挙動不具合を修正
- プレイリスト：ドラッグ＆ドロップでのプレイリスト項目パスが不正になることがある不具合修正
- プレイリスト：動画ブックを登録するときにファイル名が重複しないようにした
- プレイリスト：プレイリストブックの圧縮ファイルページをコピーしたときの不具合修正

----

これ以前の更新履歴は[こちら](https://bitbucket.org/neelabo/neeview/wiki/ChangeLog)を参照してください。
